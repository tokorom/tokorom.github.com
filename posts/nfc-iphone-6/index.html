<!DOCTYPE html>
<html lang="ja">
<head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<title>NFCタグ で鍵を開けよう（6） iOS13時代の最終形 | TOKOROM BLOG</title>

<meta content="IE=edge" http-equiv="X-UA-Compatible"><meta name="description" content="この記事は「NFCタグ で鍵を開けよう」シリーズの第6弾です。 これで最後の予定です。
NFCタグにURIを書き込む iPhoneを鍵とし、ドアにNFCタグを設置するパターン iOSアプリを経由してセキュリティレベルをあげる NFCタグを鍵とし、ドアにNFCリーダーを設置するパターン（まだ書いてないけど気が向いたら書くかも） より実用的にしていくために iOS13時代の最終形（この記事） 3〜5についてはiOS13の機能を使った最終形で、もうこれでいいじゃん！となったのでスキップします。（NFCタグを鍵にするパターンはまだ必要なケースあるかも）
なにができる？ iOS 13でNFCタグをトリガーとしてアプリを叩けるようになった iOS 13（正確にはiOS 13.1）で、純正アプリの ショートカット にオートメーションという機能が追加されました。 このオートメーションのトリガーの１つに、なんと NFCタグ があるのです。
そして、それをトリガーとしてサードパーティ製アプリの Siri Shortcut を呼び出せます。 つまり、アプリがSiri Shortcutに対応していれば、そのアプリをNFCタグタッチだけで動作させられるようになったということです。 そして、我らがSesameもこれに対応しています。
１行でまとめると、
iOS 13なら何も開発しないで、NFCタグタッチでSesameの解錠ができる ということです。
対応デバイス 正確には、iOS 13であっても Background Tag Reading に対応したiPhoneでないとこの機能は使えません。2019年10月時点での対応機種は、
iPhone XR iPhone XS iPhone XS Max iPhone 11 iPhone 11 Pro iPhone 11 Pro Max の６機種です。
実際にやってみよう NFCタグの準備 NFCタグには何も情報を書き込む必要はありません。
など適当なNFCタグを買ってきたままそのまま使えます。
オートメーションの作成 次に、ショートカットアプリでオートメーションを設定します。
解錠をマイショートカットとして追加 Sesameを普段から使っていれば、ギャラリータブの中に 「xxx」を解錠 というSesame用のショートカットが含まれているはずです。それに適当な音声コマンドをあてて Siriに追加 をしておきます。Siriに追加されたショートカットをオートメーションのアクションとして指定できるようになります。
オートメーションを追加 それでは、実際にNFCタグタッチによるオートメーションを追加してみましょう。"><meta name="author" content="tokorom">
<meta content="summary_large_image" name="twitter:card">
<meta content="@tokorom" name="twitter:site">
<meta content="website" property="og:type">
<meta content="NFCタグ で鍵を開けよう（6） iOS13時代の最終形 | TOKOROM BLOG" property="og:title"><meta content="この記事は「NFCタグ で鍵を開けよう」シリーズの第6弾です。 これで最後の予定です。
NFCタグにURIを書き込む iPhoneを鍵とし、ドアにNFCタグを設置するパターン iOSアプリを経由してセキュリティレベルをあげる NFCタグを鍵とし、ドアにNFCリーダーを設置するパターン（まだ書いてないけど気が向いたら書くかも） より実用的にしていくために iOS13時代の最終形（この記事） 3〜5についてはiOS13の機能を使った最終形で、もうこれでいいじゃん！となったのでスキップします。（NFCタグを鍵にするパターンはまだ必要なケースあるかも）
なにができる？ iOS 13でNFCタグをトリガーとしてアプリを叩けるようになった iOS 13（正確にはiOS 13.1）で、純正アプリの ショートカット にオートメーションという機能が追加されました。 このオートメーションのトリガーの１つに、なんと NFCタグ があるのです。
そして、それをトリガーとしてサードパーティ製アプリの Siri Shortcut を呼び出せます。 つまり、アプリがSiri Shortcutに対応していれば、そのアプリをNFCタグタッチだけで動作させられるようになったということです。 そして、我らがSesameもこれに対応しています。
１行でまとめると、
iOS 13なら何も開発しないで、NFCタグタッチでSesameの解錠ができる ということです。
対応デバイス 正確には、iOS 13であっても Background Tag Reading に対応したiPhoneでないとこの機能は使えません。2019年10月時点での対応機種は、
iPhone XR iPhone XS iPhone XS Max iPhone 11 iPhone 11 Pro iPhone 11 Pro Max の６機種です。
実際にやってみよう NFCタグの準備 NFCタグには何も情報を書き込む必要はありません。
など適当なNFCタグを買ってきたままそのまま使えます。
オートメーションの作成 次に、ショートカットアプリでオートメーションを設定します。
解錠をマイショートカットとして追加 Sesameを普段から使っていれば、ギャラリータブの中に 「xxx」を解錠 というSesame用のショートカットが含まれているはずです。それに適当な音声コマンドをあてて Siriに追加 をしておきます。Siriに追加されたショートカットをオートメーションのアクションとして指定できるようになります。
オートメーションを追加 それでは、実際にNFCタグタッチによるオートメーションを追加してみましょう。" property="og:description"><meta content="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/sesame.png" property="og:image"><meta content="https://www.tokoro.me/posts/nfc-iphone-6/"  property="og:url"><meta content="TOKOROM BLOG" property="og:site_name">
<link href="/images/favicon.ico" rel="shortcut icon">


    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism-okaidia.min.css">
    



    
        
    
        
            <link rel="stylesheet" href="/dist/main.658097b14612c65a4f31.min.css">
        
    




  <link rel='canonical' href='https://www.tokoro.me/posts/nfc-iphone-6/'>
</head>
<body>
    

    


<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://www.tokoro.me"><img src="/images/top_logo.png" alt="TOKOROM" height="30"></a>
    </div>
</nav>


<article class="content-page entry-body">
  <h1 class="page-title">NFCタグ で鍵を開けよう（6） iOS13時代の最終形</h1>

  <div class="entry-data">
    <span class="entry-data-date">2019年10月30日</span>
  </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/nfc">
              nfc
          </a>
          /<a class="badge badge-pill badge-light border mr-2" href="/tags/sesame">
              sesame
          </a>
          /<a class="badge badge-pill badge-light border mr-2" href="/tags/ios">
              ios
          </a>
          /</div><div class="content">
      <p>この記事は「NFCタグ で鍵を開けよう」シリーズの第6弾です。
これで最後の予定です。</p>
<ol>
<li><a href="https://www.tokoro.me/posts/nfc-iphone-1/">NFCタグにURIを書き込む</a></li>
<li><a href="http://www.tokoro.me/posts/nfc-iphone-2/">iPhoneを鍵とし、ドアにNFCタグを設置するパターン</a></li>
<li><s>iOSアプリを経由してセキュリティレベルをあげる</s></li>
<li><s>NFCタグを鍵とし、ドアにNFCリーダーを設置するパターン</s>（まだ書いてないけど気が向いたら書くかも）</li>
<li><s>より実用的にしていくために</s></li>
<li>iOS13時代の最終形（この記事）</li>
</ol>
<p>3〜5についてはiOS13の機能を使った最終形で、もうこれでいいじゃん！となったのでスキップします。（NFCタグを鍵にするパターンはまだ必要なケースあるかも）</p>
<h2 id="なにができる">なにができる？</h2>
<h3 id="ios-13でnfcタグをトリガーとしてアプリを叩けるようになった">iOS 13でNFCタグをトリガーとしてアプリを叩けるようになった</h3>
<p>iOS 13（正確にはiOS 13.1）で、純正アプリの <strong>ショートカット</strong> にオートメーションという機能が追加されました。
このオートメーションのトリガーの１つに、なんと <strong>NFCタグ</strong> があるのです。</p>
<p>そして、それをトリガーとしてサードパーティ製アプリの <strong>Siri Shortcut</strong> を呼び出せます。
つまり、アプリがSiri Shortcutに対応していれば、そのアプリをNFCタグタッチだけで動作させられるようになったということです。
そして、我らがSesameもこれに対応しています。</p>
<p>１行でまとめると、</p>
<pre><code>iOS 13なら何も開発しないで、NFCタグタッチでSesameの解錠ができる
</code></pre>
<p>ということです。</p>
<h3 id="対応デバイス">対応デバイス</h3>
<p>正確には、iOS 13であっても <strong>Background Tag Reading</strong> に対応したiPhoneでないとこの機能は使えません。2019年10月時点での対応機種は、</p>
<ul>
<li>iPhone XR</li>
<li>iPhone XS</li>
<li>iPhone XS Max</li>
<li>iPhone 11</li>
<li>iPhone 11 Pro</li>
<li>iPhone 11 Pro Max</li>
</ul>
<p>の６機種です。</p>
<h2 id="実際にやってみよう">実際にやってみよう</h2>
<h3 id="nfcタグの準備">NFCタグの準備</h3>
<p>NFCタグには何も情報を書き込む必要はありません。</p>
<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=tokorom-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=B00GXSGL5G&linkId=e34d60fe2a09548458913c1b2027e8b0&bc1=000000&lt1=_blank&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr">
    </iframe>
<p>など適当なNFCタグを買ってきたままそのまま使えます。</p>
<h3 id="オートメーションの作成">オートメーションの作成</h3>
<p>次に、ショートカットアプリでオートメーションを設定します。</p>
<h4 id="解錠をマイショートカットとして追加">解錠をマイショートカットとして追加</h4>
<p><img src="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/sirishortcut1.jpeg" alt="マイショートカット追加"></p>
<p>Sesameを普段から使っていれば、ギャラリータブの中に <em>「xxx」を解錠</em> というSesame用のショートカットが含まれているはずです。それに適当な音声コマンドをあてて <strong>Siriに追加</strong> をしておきます。Siriに追加されたショートカットをオートメーションのアクションとして指定できるようになります。</p>
<h3 id="オートメーションを追加">オートメーションを追加</h3>
<p><img src="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/sirishortcut2.jpeg" alt="マイショートカット追加"></p>
<p>それでは、実際にNFCタグタッチによるオートメーションを追加してみましょう。</p>
<p>まず、オートメーションタブから <strong>個人用オートメーション</strong> を作成開始します。</p>
<p><strong>設定</strong> セクションにある <strong>NFC</strong> を選択し、 <strong>スキャン</strong> でNFCタグをスキャンします。タグの名称は適当で大丈夫です。</p>
<p>その後、 <strong>アクションを追加</strong> で <strong>ショートカット</strong> を検索し、 <strong>ショートカットを実行</strong> を選択します。次の画面で青い <strong>ショートカット</strong> という文字部分をタップすると、マイショートカットの一覧が表示されますので先ほど追加した解錠用のショートカットを選択します。</p>
<p>最後に、 <strong>次へ</strong> を押した後の画面で <strong>実行の前に尋ねる</strong> のスイッチをOffにした状態で <strong>完了</strong> してください。こうすることでNFCタグタッチの後、ユーザー操作なしに解錠が実行できるようになります。</p>
<h2 id="セキュリティ大丈夫">セキュリティ大丈夫？</h2>
<p><a href="http://www.tokoro.me/posts/nfc-iphone-2/">iPhoneを鍵とし、ドアにNFCタグを設置するパターン</a> の段階では、NFCタグにURLを書き込み、そのURLを叩くことで解錠APIを実行していました。そのため、NFCタグをタッチすれば、誰のどのiPhoneでも解錠できてしまうという大変危険な状態でした。</p>
<p>一方、今回のパターンでは、NFCタグをタッチすると自分のiPhoneの中にインストールしてあるSesameが動いて解錠をしてくれます。つまり、解錠用のNFCタグを玄関の外側に貼り付けたままでも、自分以外のiPhoneで解錠をすることは不可能です。</p>
<h2 id="ちょっとした注意点とテクニック">ちょっとした注意点とテクニック</h2>
<p>これで、玄関ドアに貼り付けたNFCタグをiPhoneでタッチするだけで解錠ができるようになりました。以下、これを実用するにあたってのちょっとした注意点とテクニックを。</p>
<h3 id="金属に貼り付けたnfcタグは読み取れない">金属に貼り付けたNFCタグは読み取れない</h3>
<p>玄関ドアの材質によりますが、金属に貼り付けたNFCタグはiPhoneで読み取ることができません。その場合、他の場所にNFCタグを貼るか、他の材質のものを介在させる必要があります。</p>
<h3 id="nfcタグの貼り付け場所は自分の肩くらいの高さがよい">NFCタグの貼り付け場所は自分の肩くらいの高さがよい？</h3>
<p>NFCタグの読み取りはiPhoneをロックした状態からでも可能ですが、 <strong>iPhoneの画面が消灯している状態では発火しない</strong> という条件があります。</p>
<p>しかしiPhoneのデフォルト設定ではiPhoneを持ち上げて少し傾けると画面が自動で点灯するようになっています。つまり、玄関ドアの自分の肩くらいの高さにNFCタグがあると、そこにiPhoneでタッチしようとする動作の途中で画面が自動的に点灯します。こうすることで、実質iPhoneを無操作でタッチするだけで解錠することができるようになります。</p>
<h2 id="ショートカット便利すぎ">ショートカット便利すぎ</h2>
<p>ショートカットアプリを使ったオートメーションの良いところの１つとして、利用者ごとにオートメーションをカスタマイズできるというのがあります。</p>
<p>NFCタグをタッチしたあと、解錠だけでなく出勤記録を自動で付けるとか、ロボットにおかえり！を言わせるとか作り込みさえすればなんでも一緒にできそうです。そのあたりはお好みで。</p>
<p>ショートカットのこれからが楽しみです！</p>

  </div>
</article>


<div class="wrapper">
  <div class="entry-feed-title">Related Entries</div>
  <div class="entry-feed"><div class="feed-item">
  
  <a href="/posts/nfc-iphone-2/">
    <div class="feed-item-image-wrapper"><img data-src="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/sesame.png" class="feed-item-image" alt="NFCタグ で鍵を開けよう（2） iPhoneを鍵とし、ドアにNFCタグを設置するパターン" width="300"></div>

    <span class="feed-item-title">NFCタグ で鍵を開けよう（2） iPhoneを鍵とし、ドアにNFCタグを設置するパターン</span>
    <span class="feed-item-date">2019年4月1日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
<div class="feed-item">
  
  <a href="/posts/nfc-iphone-1/">
    <div class="feed-item-image-wrapper"><img data-src="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/sesame.png" class="feed-item-image" alt="NFCタグ で鍵を開けよう（1） NFCタグにURIを書き込む" width="300"></div>

    <span class="feed-item-title">NFCタグ で鍵を開けよう（1） NFCタグにURIを書き込む</span>
    <span class="feed-item-date">2019年4月1日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
<div class="feed-item">
  
  <a href="/posts/lottie-ios-1/">
    <div class="feed-item-image-wrapper"><img data-src="https://raw.githubusercontent.com/tokorom/tokorom.github.com/images/images/yes.png" class="feed-item-image" alt="Lottieでアプリにアニメーションを組み込む話（iOSプログラマー編）" width="300"></div>

    <span class="feed-item-title">Lottieでアプリにアニメーションを組み込む話（iOSプログラマー編）</span>
    <span class="feed-item-date">2018年6月6日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
<div class="feed-item">
  
  <a href="/posts/homekit_delongi_heater/">
    <div class="feed-item-image-wrapper"><img data-src="https://qiita-image-store.s3.amazonaws.com/0/7883/e2d9ecaa-7f81-761e-46ac-ca1555bdab71.png" class="feed-item-image" alt="[HomeKit対応仕様] デロンギ マルチダイナミックヒーター" width="300"></div>

    <span class="feed-item-title">[HomeKit対応仕様] デロンギ マルチダイナミックヒーター</span>
    <span class="feed-item-date">2018年2月8日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
<div class="feed-item">
  
  <a href="/posts/homekit_hue_sensor/">
    <div class="feed-item-image-wrapper"><img data-src="https://qiita-image-store.s3.amazonaws.com/0/7883/a368e9a9-87fb-eb00-d425-0563e800440b.png" class="feed-item-image" alt="[HomeKit対応仕様] Philips Hue モーションセンサー" width="300"></div>

    <span class="feed-item-title">[HomeKit対応仕様] Philips Hue モーションセンサー</span>
    <span class="feed-item-date">2018年2月1日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
<div class="feed-item">
  
  <a href="/posts/homekit_koogeek_lightbulb/">
    <div class="feed-item-image-wrapper"><img data-src="https://qiita-image-store.s3.amazonaws.com/0/7883/77fdcc8d-0c7a-b9d5-960d-9cb55319049f.jpeg" class="feed-item-image" alt="[HomeKit対応仕様] Koogeek Wi-Fiスマート LED" width="300"></div>

    <span class="feed-item-title">[HomeKit対応仕様] Koogeek Wi-Fiスマート LED</span>
    <span class="feed-item-date">2018年1月2日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>
</div>
  <div class="entry-feed-title">Latest Entries</div>
  <div class="entry-feed">
    
      <div class="feed-item">
  
  <a href="/posts/iosdc2023-shareplay/">
    <div class="feed-item-image-wrapper"><img data-src="/images/iosdc2023-shareplay/top.jpg" class="feed-item-image" alt="[iOSDC Japan 2023] SharePlayの歴史と進化 - そしてvisionOSへ" width="300"></div>

    <span class="feed-item-title">[iOSDC Japan 2023] SharePlayの歴史と進化 - そしてvisionOSへ</span>
    <span class="feed-item-date">2023年9月18日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
      <div class="feed-item">
  
  <a href="/posts/visionos-volume-3dmodel/">
    <div class="feed-item-image-wrapper"><img data-src="/images/visionos-volume-3dmodel/top.png" class="feed-item-image" alt="[visionOSアプリ練習] SwiftUIアプリで3Dモデルを表示する" width="300"></div>

    <span class="feed-item-title">[visionOSアプリ練習] SwiftUIアプリで3Dモデルを表示する</span>
    <span class="feed-item-date">2023年6月26日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
      <div class="feed-item">
  
  <a href="/posts/wwdc2023-keynote-pro-vision/">
    <div class="feed-item-image-wrapper"><img data-src="/images/wwdc2023-keynote-vision/top.png" class="feed-item-image" alt="WWDC2023 KeynoteのApple Pro Visionの紹介をとにかく細かく視聴してコメントしました" width="300"></div>

    <span class="feed-item-title">WWDC2023 KeynoteのApple Pro Visionの紹介をとにかく細かく視聴してコメントしました</span>
    <span class="feed-item-date">2023年6月15日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
      <div class="feed-item">
  
  <a href="/posts/potatotips-74-shareplay/">
    <div class="feed-item-image-wrapper"><img data-src="/images/potatotips-74-shareplay/top.png" class="feed-item-image" alt="potatotips #74 で「5分でSharePlay入門」のLTをしました" width="300"></div>

    <span class="feed-item-title">potatotips #74 で「5分でSharePlay入門」のLTをしました</span>
    <span class="feed-item-date">2021年6月28日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
      <div class="feed-item">
  
  <a href="/posts/wwdc21-meet-group-activities/">
    <div class="feed-item-image-wrapper"><img data-src="/images/wwdc21-meet-group-activities/top.png" class="feed-item-image" alt="[WWDC21] [SharePlay] Meet Group Activitiesのまとめ" width="300"></div>

    <span class="feed-item-title">[WWDC21] [SharePlay] Meet Group Activitiesのまとめ</span>
    <span class="feed-item-date">2021年6月10日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
      <div class="feed-item">
  
  <a href="/posts/wwdc2021-keynote/">
    <div class="feed-item-image-wrapper"><img data-src="/images/wwdc2021-keynote/top.png" class="feed-item-image" alt="WWDC21 Keynote iOS 15についての発表の復習" width="300"></div>

    <span class="feed-item-title">WWDC21 Keynote iOS 15についての発表の復習</span>
    <span class="feed-item-date">2021年6月8日</span>
    <span class="feed-item-date">tokorom</span>
  </a>
</div>

    
  </div>
</div>



    <footer class="footer">
  <div class="wrapper">
    <div class="footer-contents-team">
      <h2 class="footer-contents-title">OWNER</h2>
      <div class="footer-contents-team-item">
        <img class="footer-contents-team-item-avatar" src="/images/tokorom.jpg" width="50" />
        <div class="footer-contents-team-item-position">Tokoro Yuta</div>
        <div class="footer-contents-team-item-name">所 友太</div>
        <div class="footer-contents-team-item-bio">
          合同会社Spinners所属のiOSプログラマー。<br />
          著書に『iPhoneプログラミングUIKit詳解リファレンス』『よくわかるAuto Layout（監修）』『iOS 11/12 Programming』など。
        </div>
        <div class="footer-contents-team-item-footer">
          <a class="footer-contents-team-item-footer-button" href="https://twitter.com/tokorom"><img src="/images/twitter.svg" alt="twiiter" /></a>
          <a class="footer-contents-team-item-footer-button" href="https://github.com/tokorom"><img src="/images/github.svg" alt="github" /></a>
          <a class="footer-contents-team-item-footer-link" href="https://www.spinners.work">www.spinners.work</a>
        </div>
      </div>
    </div>
  </div>
  <div class="copyright">
    
        Copyright © tokorom. All Rights Reserved.
    
  </div>
</footer>

    
    
        
    
        
            <script src="/dist/main.afe12a577ea5a571a021.min.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>






    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-2451574-4', 'auto');
	
	ga('send', 'pageview');
}
</script>
</body>
</html>
